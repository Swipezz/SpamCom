<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="static/style/styletest.css">
    <title>Document</title>
</head>
<body>
    <div class="container1 position-relative">
        <div class="container2 position-absolute top-50 start-50 translate-middle position-relative">
            <div id="taskbar">
                <button id="1" class="follow-element">1</button>
                <button id="3" class="follow-element">3</button>
                <button id="4" class="follow-element">4</button>
            </div>
            <div class="hola">
                <div id="grid-container">
                    <div id="1" class="grid-item">1<button id="trash">Trash</button></div>
                    <div id="2" class="grid-item">2<button id="2" class="follow-element">2</button></div>
                    <div id="3" class="grid-item">3</div>
                    <div id="4" class="grid-item">4</div>
                    <div id="5" class="grid-item">5</div>
                    <div id="6" class="grid-item">6</div>
                    <div id="7" class="grid-item">7</div>
                    <div id="8" class="grid-item">8</div>
                    <div id="9" class="grid-item">9</div>
                    <div id="10" class="grid-item">10</div>
                    <div id="11" class="grid-item">11</div>
                    <div id="12" class="grid-item">12</div>
                    <div id="13" class="grid-item">13</div>
                    <div id="14" class="grid-item">14</div>
                    <div id="15" class="grid-item">15</div>
                    <div id="16" class="grid-item">16</div>
                    <div id="17" class="grid-item">17</div>
                    <div id="18" class="grid-item">18</div>
                    <div id="19" class="grid-item">19</div>
                    <div id="20" class="grid-item">20</div>
                    <div id="21" class="grid-item">21</div>
                    <div id="22" class="grid-item">22</div>
                    <div id="23" class="grid-item">23</div>
                    <div id="24" class="grid-item">24</div>
                    <div id="25" class="grid-item">25</div>
                    <div id="26" class="grid-item">26</div>
                    <div id="27" class="grid-item">27</div>
                    <div id="28" class="grid-item">28</div>
                    <div id="29" class="grid-item">29</div>
                    <div id="30" class="grid-item">30</div>
                    <div id="31" class="grid-item">31</div>
                    <div id="32" class="grid-item">32</div>
                    <div id="33" class="grid-item">33</div>
                    <div id="34" class="grid-item">34</div>
                    <div id="35" class="grid-item">35</div>
                    <div id="36" class="grid-item">36</div>
                    <div id="37" class="grid-item">37</div>
                    <div id="38" class="grid-item">38</div>
                    <div id="39" class="grid-item">39</div>
                    <div id="40" class="grid-item">40</div>
                    <div id="41" class="grid-item">41</div>
                    <div id="42" class="grid-item">42</div>
                    <div id="43" class="grid-item">43</div>
                    <div id="44" class="grid-item">44</div>
                    <div id="45" class="grid-item">45</div>
                    <div id="46" class="grid-item">46</div>
                    <div id="47" class="grid-item">47</div>
                    <div id="48" class="grid-item">48</div>
                    <div id="49" class="grid-item">49</div>
                    <div id="50" class="grid-item">50</div>
                    <div id="51" class="grid-item">51</div>
                    <div id="52" class="grid-item">52</div>
                    <div id="53" class="grid-item">53</div>
                    <div id="54" class="grid-item">54</div>
                    <div id="55" class="grid-item">55</div>
                    <div id="56" class="grid-item">56</div>
                    <div id="57" class="grid-item">57</div>
                    <div id="58" class="grid-item">58</div>
                    <div id="59" class="grid-item">59</div>
                    <div id="60" class="grid-item">60</div>
                    <div id="61" class="grid-item">61</div>
                    <div id="62" class="grid-item">62</div>
                    <div id="63" class="grid-item">63</div>
                    <div id="64" class="grid-item">64</div>
                    <div id="65" class="grid-item">65</div>
                    <div id="66" class="grid-item">66</div>
                    <div id="67" class="grid-item">67</div>
                    <div id="68" class="grid-item">68</div>
                    <div id="69" class="grid-item">69</div>
                    <div id="70" class="grid-item">70</div>
                    <div id="71" class="grid-item">71</div>
                    <div id="72" class="grid-item">72</div>
                </div>
            </div>
        </div>
    </div>
    <script>
        var followItems = document.querySelectorAll(".follow-element")
        var gridTiles = document.querySelectorAll(".grid-item")
        var gridContainer = document.getElementById("grid-container")

        var mouseHold = false

        function moveItem(event) {
            if (this.dataset.active === "true") {
                var maxX = this.parentElement.offsetWidth - this.offsetWidth
                var maxY = this.parentElement.offsetHeight - this.offsetHeight

                var newX = Math.min(maxX, Math.max(0, event.clientX - this.offsetWidth / 2))
                var newY = Math.min(maxY, Math.max(0, event.clientY - this.offsetHeight / 2))

                this.style.left = newX + "px"
                this.style.top = newY + "px"
            }
        }

        followItems.forEach(function(item) {
            item.addEventListener("mousedown", function(event) {
                item.dataset.active = "true"
                item.style.pointerEvents = "none"
                item.style.position = "absolute"
                item.style.zIndex = "1"
                mouseHold = true
                document.body.appendChild(item)
            })
        })

        document.addEventListener("mousemove", function(event) {
            followItems.forEach(function(item) {
                moveItem.call(item, event)
            })
        })

        document.addEventListener("mouseup", function() {
            followItems.forEach(function(item) {
                item.dataset.active = "false"
                item.style.pointerEvents = "auto"
                item.style.position = "static"
                mouseHold = false
            })
        })

        gridTiles.forEach(function(tile) {
            tile.addEventListener("mouseup", function(event) {
                followItems.forEach(function(item) {
                    if (item.dataset.active === "true") {
                        console.log(tile)
                        tile.appendChild(item)
                    }
                })
            })
        })

        document.getElementById("trash").addEventListener("mouseup", function() {
            followItems.forEach(function(item) {
                if (item.dataset.active === "true") {
                    item.remove()
                }
            })
        })

        
    </script>
</body>
</html>